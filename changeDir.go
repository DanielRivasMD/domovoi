////////////////////////////////////////////////////////////////////////////////////////////////////

package domovoi

////////////////////////////////////////////////////////////////////////////////////////////////////

import (
	"fmt"
	"os"

	"github.com/DanielRivasMD/horus"
)

////////////////////////////////////////////////////////////////////////////////////////////////////

// ChangeDir attempts to chdir into newDir.
// On failure it wraps the os.Chdir error with a fresh Herror,
// tagging it FS_ERROR and recording the target path.
func ChangeDir(newDir string) error {
	if err := os.Chdir(newDir); err != nil {
		return horus.PropagateErr(
			"ChangeDir", // Op
			"FS_ERROR",  // Category
			fmt.Sprintf("failed to change directory to %q", newDir), // Message
			err, // underlying error
			map[string]any{"target_directory": newDir}, // Details
		)
	}
	return nil
}

////////////////////////////////////////////////////////////////////////////////////////////////////
